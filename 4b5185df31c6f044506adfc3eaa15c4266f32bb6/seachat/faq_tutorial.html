<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SeaChat FAQ Tutorial &mdash; Seasalt.ai Developers 0.0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SeaChat Deployment Tutorial" href="deployment_tutorial.html" />
    <link rel="prev" title="SeaChat Cart Tutorial" href="../cart/tutorial.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >
            <a href="../index.html" class="icon icon-home"> Seasalt.ai Developers
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Product Introductions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../product_introduction/seax.html">SeaX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../product_introduction/seavoice.html">SeaVoice</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SeaChat</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">SeaChat Quick Start</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="bot_tutorial.html">SeaChat Bot Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="policy_tutorial.html">SeaChat Policy Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cart/tutorial.html">SeaChat Cart Tutorial</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">SeaChat FAQ Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="deployment_tutorial.html">SeaChat Deployment Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_files.html">Bot Tutorial Example Files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="policy.html">SeaChat Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">SeaChat FAQ</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SeaChat-cart</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cart/readme.html">SeaChat Cart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cart/seachat_cart.html">Technical Docs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SeaWord</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../nlp/readme.html">SeaWord</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nlp/sum_tutorial.html">Summarization API Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nlp/topic_tutorial.html">Topic Extraction API Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nlp/action_tutorial.html">Action Extraction API Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nlp/xlingualNER_tutorial.html">Cross Lingual NER API Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nlp/mr_tutorial.html">Machine Reading API Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nlp/redaction_tutorial.html">Redaction Service Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SeaVoice (Seasalt speech)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../speech/readme.html">SeaVoice README</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech/seavoice_sdk_python_tutorial.html">SeaVoice SDK (Python)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech/seavoice_restful_apis_tutorial.html">SeaVoice RESTful APIs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">NearMe</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../nearme/readme.html">NearMe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nearme/data_analytics_tutorial.html">NearMe Data Analytics Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SeaChat-report</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../report/index.html">Welcome to SeaChat-report’s documentation!</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Seasalt.ai Developers</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="bot_tutorial.html">SeaChat Bot Tutorial</a> &raquo;</li>
      <li>SeaChat FAQ Tutorial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/seachat/faq_tutorial.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="seachat-faq-tutorial">
<span id="faq-tutorial"></span><h1>SeaChat FAQ Tutorial<a class="headerlink" href="#seachat-faq-tutorial" title="Permalink to this headline"></a></h1>
<p>For additional support to Rasa bots, SeaChat offers a FAQ component that is faster and more accurate the Rasa’s ResponseSelector.
This tutorial will walk through how to format the data, import the data, and add the FAQ component to the NLU pipeline.</p>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#creating-the-data" id="id1">Creating the Data</a></p></li>
<li><p><a class="reference internal" href="#configuration" id="id2">Configuration</a></p>
<ul>
<li><p><a class="reference internal" href="#importing-the-data" id="id3">Importing the Data</a></p></li>
<li><p><a class="reference internal" href="#adding-faq-to-the-nlu-pipeline" id="id4">Adding FAQ to the NLU pipeline</a></p></li>
<li><p><a class="reference internal" href="#adding-faq-to-the-bot" id="id5">Adding FAQ to the Bot</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#try-it" id="id6">Try It</a></p></li>
</ul>
</div>
<section id="creating-the-data">
<h2><a class="toc-backref" href="#id1">Creating the Data</a><a class="headerlink" href="#creating-the-data" title="Permalink to this headline"></a></h2>
<p>In addition to Rasa’s native markdown data format, SeaChat FAQ also supports comma-separated-value format.
We will use the csv version to demonstrate how the data should be formatted and imported.
To start, create a new file in your bot directory: <code class="docutils literal notranslate"><span class="pre">data/faq.csv</span></code>.
The file has a <em>required</em> header of the following format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ID</span><span class="p">,</span><span class="n">Answer</span><span class="p">,</span><span class="n">Category</span><span class="p">,</span><span class="n">Keywords</span><span class="p">,</span><span class="n">From</span> <span class="n">date</span><span class="p">,</span><span class="n">To</span> <span class="n">date</span><span class="p">,</span><span class="n">Question</span><span class="p">,</span><span class="n">Question</span><span class="p">,</span><span class="n">More</span> <span class="n">Questions</span><span class="p">,</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While there are only 3 columns specified for questions in the header, as many questions as necessary can be added by continuing into new columns. However, the header should not be changed, even if more columns are added.</p>
</div>
<p>Copy and paste this header into the top of your faq file.
For this tutorial, we will only work with the <code class="docutils literal notranslate"><span class="pre">ID</span></code>, <code class="docutils literal notranslate"><span class="pre">Answer</span></code>, and <code class="docutils literal notranslate"><span class="pre">Question</span></code> fields.
See <a class="reference internal" href="faq.html#faq-csv-format"><span class="std std-ref">CSV format</span></a> in the FAQ overview for detailed information about
Here’s our first FAQ question and answer about store hours:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 3%" />
<col style="width: 22%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 8%" />
<col style="width: 6%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 15%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>ID</p></td>
<td><p>Answer</p></td>
<td><p>Category</p></td>
<td><p>Keywords</p></td>
<td><p>From date</p></td>
<td><p>To date</p></td>
<td><p>Question</p></td>
<td><p>Question</p></td>
<td><p>Question</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>We are open Mon-Fri 7am-5pm</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><p>when are you open?</p></td>
<td><p>What are you hours?</p></td>
<td><p>Are you open now?</p></td>
</tr>
</tbody>
</table>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If a column is not used, it should be left blank, but the column itself should not be removed.</p>
</div>
<p>See a full example in csv format <a class="reference internal" href="tutorial_resources/bot_faq.html#bot-faq-example"><span class="std std-ref">here</span></a>.</p>
</section>
<section id="configuration">
<h2><a class="toc-backref" href="#id2">Configuration</a><a class="headerlink" href="#configuration" title="Permalink to this headline"></a></h2>
<p>Now that we have some FAQ data, the bot must be configured to import and use the data in the NLU pipeline.
Open your <code class="docutils literal notranslate"><span class="pre">config.yml</span></code> file.</p>
<section id="importing-the-data">
<h3><a class="toc-backref" href="#id3">Importing the Data</a><a class="headerlink" href="#importing-the-data" title="Permalink to this headline"></a></h3>
<p>In the config, we will need to add a new section called <code class="docutils literal notranslate"><span class="pre">importers</span></code>.
To add the SeaChat FAQ importer, add the name as the path to the <code class="docutils literal notranslate"><span class="pre">FAQImporter</span></code> class.
Specify the paths to the csv files under <code class="docutils literal notranslate"><span class="pre">faq_paths</span></code>.
You can also optionally specify the <code class="docutils literal notranslate"><span class="pre">augment_with_synonyms</span></code> and <code class="docutils literal notranslate"><span class="pre">timezone</span></code> fields.</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">importers</span><span class="p">:</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">seachat_plugins.importers.faq_importer.FAQImporter</span><span class="w"></span>
<span class="w">  </span><span class="nt">faq_paths</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data/faq.csv</span><span class="w"></span>
<span class="w">  </span><span class="nt">augment_with_synonyms</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">  </span><span class="nt">timezone</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">America/Los_Angeles</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RasaFileImporter</span><span class="w"></span>
</pre></div>
</div>
<p>Next, we can specify the regular Rasa importer so that our Rasa formatted files are still imported properly.</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">importers</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RasaFileImporter</span><span class="w"></span>
</pre></div>
</div>
<p>For a more detailed explanation of how the importer can be configured, see <a class="reference internal" href="faq.html#faq-importer"><span class="std std-ref">FAQImporter</span></a> in the FAQ overview.</p>
</section>
<section id="adding-faq-to-the-nlu-pipeline">
<h3><a class="toc-backref" href="#id4">Adding FAQ to the NLU pipeline</a><a class="headerlink" href="#adding-faq-to-the-nlu-pipeline" title="Permalink to this headline"></a></h3>
<p>Finally, we need to add the SeaChat selector component to the NLU pipeline.
We can simply replace Rasa’s <code class="docutils literal notranslate"><span class="pre">ResponseSelector</span></code> component with a path to the ElasticSelector class.
For this tutorial bot we will set up ElasticSearch to use a local service and will skip using BERT word embeddings.
See <a class="reference internal" href="faq.html#elastic-selector"><span class="std std-ref">ElasticSelector</span></a> in the FAQ overview for detailed information about how the component can be configured.
For now, the following can be copied and pasted into the <code class="docutils literal notranslate"><span class="pre">config.yml</span></code> file in place of Rasa’s ResponseSelector.</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">seachat_plugins.nlu.selectors.elastic_selector.ElasticSelector</span><span class="w"></span>
<span class="w">  </span><span class="nt">es_indexing</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">index_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tutorial_faq</span><span class="w"></span>
<span class="w">    </span><span class="c1"># On the k8s cluster, login/secret will be set automatically.</span><span class="w"></span>
<span class="w">    </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">localhost</span><span class="w"> </span><span class="c1"># or elastic.seasalt.ai for the cluster</span><span class="w"></span>
<span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9200</span><span class="w"></span>
</pre></div>
</div>
<p>These are the minimal configurations required to run the ElasticSelector. For additional configurations, such a re-ranking and BERT embedding integration, see the <a class="reference internal" href="faq.html#seachat-faq"><span class="std std-ref">FAQ Overview</span></a>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you are running the bot locally, make sure you have an instance of ElasticSearch running <em>before</em> you start to train or test the bot.</p>
</div>
</section>
<section id="adding-faq-to-the-bot">
<h3><a class="toc-backref" href="#id5">Adding FAQ to the Bot</a><a class="headerlink" href="#adding-faq-to-the-bot" title="Permalink to this headline"></a></h3>
<p>Once the FAQ components are integrated in the config, there are a few more steps to make sure that bot accurately responds to the query.
First, the faq intent and action names must be added to the bot domain.
To the <code class="docutils literal notranslate"><span class="pre">intents</span></code> list in the <code class="docutils literal notranslate"><span class="pre">domain.yml</span></code> file, add <code class="docutils literal notranslate"><span class="pre">faq</span></code>.</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">intents</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">faq</span><span class="w"></span>
</pre></div>
</div>
<p>This intent name should match the <code class="docutils literal notranslate"><span class="pre">retrieval_intent</span></code> field on the ElasticSelector configuration.
Also, add <code class="docutils literal notranslate"><span class="pre">utter_faq</span></code> to the <code class="docutils literal notranslate"><span class="pre">actions</span></code> list.
This is the default action name for the ElasticSelectors action.</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">actions</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">utter_faq</span><span class="w"></span>
</pre></div>
</div>
<p>Finally, we will need to add a new state to the <code class="docutils literal notranslate"><span class="pre">dialogue.yml</span></code> file that recognizes the FAQ intent, and returns the <code class="docutils literal notranslate"><span class="pre">respond_faq</span></code> action.</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$[faq]</span><span class="p p-Indicator">:</span><span class="w"></span>
<span class="nt">rank_score</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span><span class="w"></span>
<span class="nt">conditions</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">INTENT.name == &#39;faq&#39;</span><span class="w"></span>
<span class="nt">actions</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">utter_faq</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">action_listen</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="try-it">
<h2><a class="toc-backref" href="#id6">Try It</a><a class="headerlink" href="#try-it" title="Permalink to this headline"></a></h2>
<p>We can now test that the new FAQ selector is working as expected.
Retrain your bot, Make sure an ElasticSearch instance is running, and start the bot in the terminal.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ rasa train
$ rasa shell -vv
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../cart/tutorial.html" class="btn btn-neutral float-left" title="SeaChat Cart Tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="deployment_tutorial.html" class="btn btn-neutral float-right" title="SeaChat Deployment Tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2021, Seasalt.ai.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-10405841-8"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-10405841-8', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>