<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SeaChat Policy &mdash; Seasalt.ai Developers 0.0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SeaChat-FAQ" href="faq.html" />
    <link rel="prev" title="FAQ Data Example" href="tutorial_resources/bot_faq.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >
            <a href="../index.html" class="icon icon-home"> Seasalt.ai Developers
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Product Introductions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../product_introduction/seax.html">SeaX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../product_introduction/seavoice.html">SeaVoice</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SeaChat</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">SeaChat Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="bot_tutorial.html">SeaChat Bot Tutorial</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">SeaChat Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">SeaChat FAQ</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SeaChat-cart</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cart/readme.html">SeaChat Cart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cart/seachat_cart.html">Technical Docs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SeaWord</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../nlp/readme.html">SeaWord</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nlp/sum_tutorial.html">Summarization API Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nlp/topic_tutorial.html">Topic Extraction API Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nlp/action_tutorial.html">Action Extraction API Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nlp/xlingualNER_tutorial.html">Cross Lingual NER API Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nlp/mr_tutorial.html">Machine Reading API Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nlp/redaction_tutorial.html">Redaction Service Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SeaVoice (Seasalt speech)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../speech/readme.html">SeaVoice README</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech/seavoice_sdk_python_tutorial.html">SeaVoice SDK (Python)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech/seavoice_restful_apis_tutorial.html">SeaVoice RESTful APIs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">NearMe</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../nearme/readme.html">NearMe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nearme/data_analytics_tutorial.html">NearMe Data Analytics Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SeaChat-report</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../report/index.html">Welcome to SeaChat-report’s documentation!</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Seasalt.ai Developers</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>SeaChat Policy</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/seachat/policy.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="seachat-policy">
<span id="policy"></span><h1>SeaChat Policy<a class="headerlink" href="#seachat-policy" title="Permalink to this headline"></a></h1>
<p>SeaChat Policy is a dialogue management system that can be integrated as a component to Rasa Core.</p>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#purpose" id="id1">Purpose</a></p></li>
<li><p><a class="reference internal" href="#implementation" id="id2">Implementation</a></p></li>
<li><p><a class="reference internal" href="#policy-pseudo-code" id="id3">Policy Pseudo-code</a></p></li>
<li><p><a class="reference internal" href="#rasa-integration" id="id4">Rasa Integration</a></p></li>
<li><p><a class="reference internal" href="#dialogue-yml-file" id="id5">Dialogue.yml File</a></p>
<ul>
<li><p><a class="reference internal" href="#dialogue-schema" id="id6">Dialogue Schema</a></p></li>
<li><p><a class="reference internal" href="#rank-score" id="id7">Rank Score</a></p></li>
<li><p><a class="reference internal" href="#direct-connection" id="id8">Direct Connection</a></p></li>
<li><p><a class="reference internal" href="#conditions" id="id9">Conditions</a></p></li>
<li><p><a class="reference internal" href="#actions" id="id10">Actions</a></p></li>
<li><p><a class="reference internal" href="#connections" id="id11">Connections</a></p></li>
<li><p><a class="reference internal" href="#dialogue-example" id="id12">Dialogue Example</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#visualization" id="id13">Visualization</a></p>
<ul>
<li><p><a class="reference internal" href="#interpreting-the-graphic" id="id14">Interpreting the Graphic</a></p></li>
<li><p><a class="reference internal" href="#how-to-use-policy" id="id15">How to Use Policy</a></p></li>
<li><p><a class="reference internal" href="#write-the-dialogue-file" id="id16">Write the Dialogue File</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="purpose">
<h2><a class="toc-backref" href="#id1">Purpose</a><a class="headerlink" href="#purpose" title="Permalink to this headline"></a></h2>
<p>The purpose of a dialogue management system is to decide at each moment in the conversation which action the bot should take next.
The foundation of Rasa’a dialogue management relies on the TEDPolicy, a transformer model that is trained on conversation ‘stories’, which contain user intents &amp; entities paired with the desired bot responses and actions.
While the TEDPolicy is excellent at handling conversational context and responding to unique dialogues, we find it is too heavy weight and too unpredictable for some conversations that follow a simple and consistent path.
The purpose of SeaChat Dialogue Policy is to provide an alternative which allows developers to have complete control over the bots response to specified situations.</p>
</section>
<section id="implementation">
<h2><a class="toc-backref" href="#id2">Implementation</a><a class="headerlink" href="#implementation" title="Permalink to this headline"></a></h2>
<p>The SeaChat Policy is written as a subclass of the Rasa policy class (rasa.core.policies.policy.policy).
The policy determines the next action based on a set of hand-written rules which are loaded in from a separate yaml file.
These rules are represented as states and the policy itself can be thought of as a finite state machine, where each state has a set of entrance conditions, connections to other states, and a set of actions to execute if the bot enters that state.
Most states are enter-states, meaning that they can be entered at any point in the conversation if their conditions are met; others are direct-connect states meaning that they can only be entered if the bot’s previous state connects to it.
Every time the bot needs to make a decision (usually after a user utterance) the policy evaluates the entrance conditions of each state, calculates a score for each enterable state, and then executes the actions of the highest ranked state.
The bot will continue to do this until a listen action is triggered, at which point it will stop to listen to the user’s input.</p>
<dl class="simple">
<dt>The score of each state is calculated as the sum of 4 values:</dt><dd><ul class="simple">
<li><p>The number of entrance conditions it has (+1 per)</p></li>
<li><p>Rank score specified in dialogue.yml (+rank_score, default: 10)</p></li>
<li><p>If the bot’s previous state connects to it (+5)</p></li>
<li><p>If that connection is a direct connection (+1000)</p></li>
</ul>
</dd>
</dl>
<p>Once a state is selected, the bot will execute all the actions from that state before re-evaluating. If no state’s entrance conditions can be met, it will trigger Rasa’s DEFAULT_ACTION_FALLBACK followed by a listen action. Similarly, if the confidence level of the user intent is below the NLU threshold, the policy will trigger the fallback.</p>
</section>
<section id="policy-pseudo-code">
<h2><a class="toc-backref" href="#id3">Policy Pseudo-code</a><a class="headerlink" href="#policy-pseudo-code" title="Permalink to this headline"></a></h2>
<p>Upon startup:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Get</span> <span class="nb">all</span> <span class="n">intent</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="ow">and</span> <span class="n">action</span> <span class="n">names</span> <span class="kn">from</span> <span class="nn">domain</span>
<span class="n">Load</span> <span class="n">dialogue</span><span class="o">.</span><span class="n">yml</span> <span class="ow">and</span> <span class="n">check</span> <span class="n">validity</span>
<span class="n">Store</span> <span class="n">states</span> <span class="k">as</span> <span class="n">a</span> <span class="n">graph</span> <span class="k">with</span> <span class="n">a</span> <span class="nb">dict</span> <span class="n">to</span> <span class="n">access</span> <span class="n">each</span> <span class="n">node</span> <span class="o">-&gt;</span> <span class="n">name2state</span>

<span class="c1"># build a graph of states recursively</span>
<span class="n">build_state_graph</span><span class="p">():</span>
  <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">dialogue</span><span class="o">.</span><span class="n">yml</span><span class="p">:</span>
    <span class="n">build_state_graph_recursively</span><span class="p">():</span>
      <span class="n">enter_state_dict</span><span class="p">[</span><span class="n">state_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span> <span class="n">state</span> <span class="nb">object</span>
      <span class="k">if</span> <span class="n">new</span> <span class="n">state</span> <span class="nb">object</span> <span class="n">has</span> <span class="n">connections</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">each</span> <span class="n">connection</span> <span class="n">build_state_graph_recursively</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
<span class="c1"># result: a dictionary where the key is the state name and the value is the state object</span>
</pre></div>
</div>
<p>Upon Prediction:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">predict_action_probabilities</span><span class="p">():</span>
  <span class="k">if</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">chain</span> <span class="n">of</span> <span class="n">actions</span> <span class="n">to</span> <span class="n">be</span> <span class="n">executed</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">next</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">chain</span>
  <span class="k">if</span> <span class="n">machine</span> <span class="n">reading</span> <span class="ow">is</span> <span class="n">activated</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">machine</span> <span class="n">reading</span> <span class="n">score</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">machine</span> <span class="n">reading</span> <span class="n">action</span>
  <span class="k">if</span> <span class="n">the</span> <span class="n">NLU</span> <span class="n">confidence</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">fallback</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">get_predicted_action</span><span class="p">():</span>
      <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">name2state</span><span class="p">:</span>
        <span class="n">get_rank_score</span><span class="p">():</span>
            <span class="c1"># Use Rasa tracker and domain to evaluate each state&#39;s entrance conditions</span>
            <span class="k">if</span> <span class="nb">any</span> <span class="n">condition</span> <span class="n">evaluates</span> <span class="n">false</span><span class="p">:</span>
              <span class="k">return</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">direct_connection</span> <span class="ow">is</span> <span class="kc">True</span> <span class="n">but</span> <span class="n">current_state</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">connect</span><span class="p">:</span>
              <span class="k">return</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">direct_connection</span> <span class="ow">is</span> <span class="n">true</span> <span class="ow">and</span> <span class="n">current_state</span> <span class="n">connects</span><span class="p">:</span>
              <span class="k">return</span> <span class="mi">1000</span>
            <span class="k">if</span> <span class="n">direct_connection</span> <span class="ow">is</span> <span class="n">false</span> <span class="n">but</span> <span class="n">current_state</span> <span class="n">connects</span><span class="p">:</span>
              <span class="k">return</span> <span class="mi">5</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
              <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">highest</span> <span class="n">state</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
          <span class="n">current_state</span> <span class="o">=</span> <span class="n">highest_state</span>
          <span class="k">return</span> <span class="n">highest_state</span><span class="o">.</span><span class="n">actions</span>
        <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">action_chain</span> <span class="o">=</span> <span class="n">highest_state</span><span class="o">.</span><span class="n">actions</span>
      <span class="k">return</span> <span class="n">first</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">action</span> <span class="n">chain</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="n">fallback</span>
</pre></div>
</div>
</section>
<section id="rasa-integration">
<h2><a class="toc-backref" href="#id4">Rasa Integration</a><a class="headerlink" href="#rasa-integration" title="Permalink to this headline"></a></h2>
<p>Rasa’s dialogue manager (Rasa Core) is built out of components called policies.
Every policy is consulted each time the bot needs to make a decision, and each provides a suggested next action and a confidence score.
Rasa Core chooses the policy with the highest confidence, or in case of a tie, the policy with the highest priority.
SeaChat Dialogue Policy is designed to work as a standalone dialogue manager, meaning that it is not necessary to use any of Rasa’s policies.
However, it can be used in conjunction with any of Rasa’s policies.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The SeaChat Policy always returns a confidence of 1 or 0 and its default priority level is 1.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>currently SeaChat policy always handles fallbacks; future updates may include introducing a parameter that can turn this off so it can be used with other policies.</p>
</div>
</section>
<section id="dialogue-yml-file">
<h2><a class="toc-backref" href="#id5">Dialogue.yml File</a><a class="headerlink" href="#dialogue-yml-file" title="Permalink to this headline"></a></h2>
<p>The dialogue.yml file is the set of rules, or states, that the policy will use to make its decisions.</p>
<section id="dialogue-schema">
<h3><a class="toc-backref" href="#id6">Dialogue Schema</a><a class="headerlink" href="#dialogue-schema" title="Permalink to this headline"></a></h3>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$[state name]</span><span class="p p-Indicator">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">direct_connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bool</span><span class="w"></span>
<span class="w">  </span><span class="nt">rank_score</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">int</span><span class="w"></span>
<span class="w">  </span><span class="nt">conditions</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">list[Text]</span><span class="w"></span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain"># a list of evaluatable strings</span><span class="w"></span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain"># can reference certain variables such as SLOTS, INTENT, etc</span><span class="w"></span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">- INTENT.name == &#39;greet&#39;</span><span class="w"></span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">- SLOTS.username is not None</span><span class="w"></span>
<span class="w">  </span><span class="nt">actions</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">list[Text]</span><span class="w"></span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain"># a list of action names as defined in domain.yml</span><span class="w"></span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain"># actions will be executed in order and will continue until an action_listen is triggered</span><span class="w"></span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">- utter_greet</span><span class="w"></span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">- action_greet_user_by_name</span><span class="w"></span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">- action_listen</span><span class="w"></span>
<span class="w">  </span><span class="nt">connections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">State</span><span class="w"></span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">- $[state name 2]</span><span class="p p-Indicator">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">direct_connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">        </span><span class="nt">conditions</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">state2 is true</span><span class="w"></span>
<span class="w">        </span><span class="nt">actions</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">action_state_two</span><span class="w"></span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Each state must have a unique name</p>
</div>
</section>
<section id="rank-score">
<h3><a class="toc-backref" href="#id7">Rank Score</a><a class="headerlink" href="#rank-score" title="Permalink to this headline"></a></h3>
<p>The rank score is used to compute the overall score of each enterable state. The default value is 10, but it can be optionally modified in dialogue.yml to give priority to certain states.</p>
<p>Example:
<code class="docutils literal notranslate"><span class="pre">rank_score:</span> <span class="pre">15</span></code></p>
</section>
<section id="direct-connection">
<h3><a class="toc-backref" href="#id8">Direct Connection</a><a class="headerlink" href="#direct-connection" title="Permalink to this headline"></a></h3>
<p>If the state’s direct connection is true, and the bot’s previous state has a connection to it, the state will get a massive rank score boost so that it is almost guarenteed to be selected if its conditions are met. A use case for this is if you ask the user a yes or no question, the response may not have enough specific detail on its own to know the next action; by knowing the previous context the policy can response to a yes/no answer with high confidence.</p>
<p>Example:
<code class="docutils literal notranslate"><span class="pre">direct_connection:</span> <span class="pre">true</span></code></p>
</section>
<section id="conditions">
<h3><a class="toc-backref" href="#id9">Conditions</a><a class="headerlink" href="#conditions" title="Permalink to this headline"></a></h3>
<p><strong>required</strong></p>
<p>The conditions are a list of evaluatable python expressions written as strings. The dialogue file has ‘access’ to certain information from the bot which can be used to evaluate conditions and execute actions. The following are the variables that can be used in the dialogue file to access information about the current state of the bot:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 21%" />
<col style="width: 59%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>VARIABLE</p></th>
<th class="head"><p>TYPE</p></th>
<th class="head"><p>DESCRIPTION</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">INTENT</span></code></p></td>
<td><p>Dict[Text, Any]</p></td>
<td><p>A dict with the most recent INTENT info of
the user. The available keys are
<code class="docutils literal notranslate"><span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">confidence</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ENTITIES</span></code></p></td>
<td><p>List[Text]</p></td>
<td><p>A list of entity names that appeared in the
last utterance</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">RESPONSES</span></code></p></td>
<td><p>Dict[Text, Any]</p></td>
<td><p>A dict of template name/utterance pairs
from the domain. For example,
<code class="docutils literal notranslate"><span class="pre">RESPONSES.greet</span></code> will return a list of
all utterance templates available for this
template.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">SLOTS</span></code></p></td>
<td><p>Dict[Text, Any]</p></td>
<td><p>A dict with slot-name slot-value pairs. For
example: <code class="docutils literal notranslate"><span class="pre">SLOTS.item</span></code> might return the user-
specified item <code class="docutils literal notranslate"><span class="pre">Americano</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">LAST_UTT</span></code></p></td>
<td><p>Text</p></td>
<td><p>The most recent utterance from the bot</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">LAST_ACTION</span></code></p></td>
<td><p>Text</p></td>
<td><p>The name of the most recent action
executed by the bot</p></td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">conditions</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">INTENT.name == &#39;greet&#39;</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SLOTS.name is None</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="actions">
<h3><a class="toc-backref" href="#id10">Actions</a><a class="headerlink" href="#actions" title="Permalink to this headline"></a></h3>
<p><strong>required</strong></p>
<p>A list of actions to be executed in order by the bot if the state is chosen. These action or utterance names should be exactly as they appear in domain.yml.</p>
<p>Example:</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">actions</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">utter_greet</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">action_ask_name</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">action_listen</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="connections">
<h3><a class="toc-backref" href="#id11">Connections</a><a class="headerlink" href="#connections" title="Permalink to this headline"></a></h3>
<p>Connections represent a chain of dialogue where you expect certain turns from the bot and user to take place in order. The connections attribute is a list of other states, and these connections can expand recursively. A connection gives a small 5 point rank score boost, or a large 1000 point boost if the direct_connection attribute is true.</p>
<p>Example:</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">connections</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$[gave name]</span><span class="p p-Indicator">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">conditions</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SLOTS.name is not None</span><span class="w"></span>
<span class="w">      </span><span class="nt">actions</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">action_greet_with_name</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="dialogue-example">
<h3><a class="toc-backref" href="#id12">Dialogue Example</a><a class="headerlink" href="#dialogue-example" title="Permalink to this headline"></a></h3>
<p>Here’s a small example of a conversation path where the user says ‘good morning’ and the bot asks if they’d like to hear today’s weather.</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$[good morning]</span><span class="p p-Indicator">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">rank_score</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span><span class="w"></span>
<span class="w">  </span><span class="nt">conditions</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">INTENT.name == &#39;good_morning&#39;</span><span class="w"></span>
<span class="w">  </span><span class="nt">actions</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">utter_good_morning</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">utter_ask_weather</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">action_listen</span><span class="w"></span>
<span class="w">  </span><span class="nt">connections</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$[weather yes]</span><span class="p p-Indicator">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">direct_connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">        </span><span class="nt">conditions</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">INTENT.name is &#39;affirm&#39;</span><span class="w"></span>
<span class="w">        </span><span class="nt">actions</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">action_get_weather</span><span class="w"></span>
<span class="w">        </span><span class="nt">connections</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$[got weather]</span><span class="p p-Indicator">:</span><span class="w"></span>
<span class="w">              </span><span class="nt">direct_connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">              </span><span class="nt">conditions</span><span class="p">:</span><span class="w"></span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SLOTS.weather is not None</span><span class="w"></span>
<span class="w">              </span><span class="nt">actions</span><span class="p">:</span><span class="w"></span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">utter_weather</span><span class="w"></span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">action_set_weather_to_none</span><span class="w"></span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">action_listen</span><span class="w"></span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$[get weather fail]</span><span class="p p-Indicator">:</span><span class="w"></span>
<span class="w">              </span><span class="nt">direct_connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">              </span><span class="nt">conditions</span><span class="p">:</span><span class="w"></span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SLOTS.weather is None</span><span class="w"></span>
<span class="w">              </span><span class="nt">actions</span><span class="p">:</span><span class="w"></span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">utter_weather_error</span><span class="w"></span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">action_listen</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$[weather no]</span><span class="p p-Indicator">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">direct_connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">        </span><span class="nt">conditions</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">INTENT.name == &#39;deny&#39;</span><span class="w"></span>
<span class="w">        </span><span class="nt">actions</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">utter_no_weather</span><span class="w"></span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">action_listen</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="visualization">
<h2><a class="toc-backref" href="#id13">Visualization</a><a class="headerlink" href="#visualization" title="Permalink to this headline"></a></h2>
<p>The policy also includes built-in visualization tools to help with developing and debugging the dialogue.yml file.
If the visualization tools are activated, during train and runtime the dialogue policy will output data to create a tree-like representation of the dialogue states.
The policy can output this data in <a class="reference external" href="https://graphviz.org/doc/info/lang.html">dot</a> and/or <a class="reference external" href="https://vega.github.io/vega/">Vega</a> format.
When using dot format, a <a class="reference external" href="https://marketplace.visualstudio.com/items?itemName=joaompinto.vscode-graphviz">vscode extension</a> can be installed to view the graphic in a window of the IDE.
If the Vega version is selected, a new window in the default web browser will automatically open when a Rasa session is started locally.
In general, the dot format is much simpler, and is generated as a static image.
The Vega format is more complex, allowing for interaction with the graphic in the web browser.
The output type can be set with the <code class="docutils literal notranslate"><span class="pre">output_json</span></code> and <code class="docutils literal notranslate"><span class="pre">output_dot</span></code> flags in the config file.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>For the vega format, the policy requires a tree specification file named <code class="docutils literal notranslate"><span class="pre">flow_data.json</span></code> to be present in the visualization directory. The tree specification contains all the information about how the tree will be rendered. The dialogue policy will read this file and output new spec files with updated <code class="docutils literal notranslate"><span class="pre">data</span></code> fields. Unlike the dot format, the vega <code class="docutils literal notranslate"><span class="pre">flow_data.json</span></code> can be updated to adjust the look of the output graphic.</p>
</div>
<p>For both formats, they can be configured for three different kind of output.
In the Rasa config file, if <code class="docutils literal notranslate"><span class="pre">output_static_visualization</span></code> is true, the bot will output a simple graphic of the full dialogue flow at train time and runtime.
If <code class="docutils literal notranslate"><span class="pre">output_at_each_turn</span></code> is true, the policy will output a separate data file with conversation-state-specific data (such as current state, enterable states, tracker data, etc).
These files will be output numerically so that the transitions of the conversation can be viewed later.
Lastly, if <code class="docutils literal notranslate"><span class="pre">output_live_update</span></code> is true, the bot will output one file titled <code class="docutils literal notranslate"><span class="pre">live_update_state_data.{ext}</span></code>, which will be overridden each time the policy is called.
The result is that the developer can view the graphic in real time while interacting with the bot.</p>
<section id="interpreting-the-graphic">
<h3><a class="toc-backref" href="#id14">Interpreting the Graphic</a><a class="headerlink" href="#interpreting-the-graphic" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li><p>Direct/indirect connections: the type of connections between nodes represents whether it is a direct connection or not.</p>
<ul>
<li><p>Dotted line = indirect connection</p></li>
<li><p>Solid line = direct connection</p></li>
</ul>
</li>
<li><p>Current state: the state that was chosen most recently. The actions from this state have already been executed by the bot.</p>
<ul>
<li><p>Green highlighted state (dot: green bot around state info; json: green dot for state node)</p></li>
</ul>
</li>
<li><p>Enterable states: all states that have their conditions met by at the current state of the conversation.</p>
<ul>
<li><p>Black connection to that node, can be dotted or solid</p></li>
</ul>
</li>
<li><p>Next state: the state that will be executed next. All of the conditions are met and it has the highest ranks score of all the enterable nodes.</p>
<ul>
<li><p>Green connection to that node, can be dotted or solid</p></li>
</ul>
</li>
<li><p>Rank score: the rank score for that state</p>
<ul>
<li><p>A number labeling the node or the transition between nodes</p></li>
</ul>
</li>
<li><p>Vega only:</p>
<ul>
<li><p>Tracker: a separate node next to to the enter node, which contains information about the current tracker state.</p></li>
<li><p>Hover actions: hovering over a node will display the conditions and actions for that node.</p></li>
</ul>
</li>
</ul>
</section>
<section id="how-to-use-policy">
<h3><a class="toc-backref" href="#id15">How to Use Policy</a><a class="headerlink" href="#how-to-use-policy" title="Permalink to this headline"></a></h3>
<p><strong>Add to config.yml</strong></p>
<p>In order to use the policy with Rasa, you must specify the policy in the configuration file. The only required field is the name, which should be the path to the SeaChatPolicy class from your working directory. Additionally, you can specify the location of the dialogue file (default: <code class="docutils literal notranslate"><span class="pre">./dialogue.yml</span></code>), and the nlu threshold that determines when the fallback action will be triggered (default: <code class="docutils literal notranslate"><span class="pre">.40</span></code>). If the bot needs to use the machine reading reviews system, you need to indicate that the policy should use it (default: <code class="docutils literal notranslate"><span class="pre">false</span></code>), as well as specifying the threshold for using the machine reading answer (default: <code class="docutils literal notranslate"><span class="pre">.40</span></code>) and the path to the required file (default: <code class="docutils literal notranslate"><span class="pre">./data/gm_reviews.text</span></code>). As a note, the machine reading reviews system only works with Rasa 2x+. The SeaChat Policy can be used as the only policy in the config, or it can be used alongside other Rasa policies.</p>
<p>Configurable parameters:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 6%" />
<col style="width: 45%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>NAME</p></th>
<th class="head"><p>TYPE</p></th>
<th class="head"><p>DESCRIPTION</p></th>
<th class="head"><p>DEFAULT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">name</span></code></p></td>
<td><p>Text</p></td>
<td><p>The path the ngChatPolicy <em>class</em>, not just the file.</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dialogue_path</span></code></p></td>
<td><p>Text</p></td>
<td><p>The path to the dialogue.yml file.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">./dialogue.yml</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">nlu_threshold</span></code></p></td>
<td><p>float</p></td>
<td><p>Fallback threshold for nlu intent classification.
If the NLU intent classification confidence is below
the threshold, the policy will default to the
fallback action.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.40</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">use_mr</span></code></p></td>
<td><p>bool</p></td>
<td><p>Whether machine reading is used in the bot.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">mr_threshold</span></code></p></td>
<td><p>float</p></td>
<td><p>Threshold for the machine reading system. If the
machine reading conficence is below the threshold,
the policy will default to the DIET classifier
classification.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.40</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">mr_text_path</span></code></p></td>
<td><p>Text</p></td>
<td><p>The path to the reviews text file.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">./data/gm_reviews.txt</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">visual</span></code></p></td>
<td><p>Dict</p></td>
<td><p>A dict of visualization configurations, see next table</p></td>
<td></td>
</tr>
</tbody>
</table>
<p>Visualization parameters:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 28%" />
<col style="width: 6%" />
<col style="width: 48%" />
<col style="width: 18%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>NAME</p></th>
<th class="head"><p>TYPE</p></th>
<th class="head"><p>DESCRIPTION</p></th>
<th class="head"><p>DEFAULT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">visualization_directory</span></code></p></td>
<td><p>Text</p></td>
<td><p>The path to a folder where the visualization
output will be stored.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">./visual</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">output_static_visualization</span></code></p></td>
<td><p>bool</p></td>
<td><p>Whether or not to output a static visualization
at train time and runtime.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">output_at_each_turn</span></code></p></td>
<td><p>bool</p></td>
<td><p>Whether or not to output an individual data file
each time the dialogue policy is called.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">output_live_update</span></code></p></td>
<td><p>bool</p></td>
<td><p>Whether or not to output a file that updates itself
in real-time.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">output_vega</span></code></p></td>
<td><p>bool</p></td>
<td><p>Whether or not to output json formatted
visualization files.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">vega_spec_path</span></code></p></td>
<td><p>Text</p></td>
<td><p>The path to a vega <code class="docutils literal notranslate"><span class="pre">flow_data.json</span></code> file</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">./visual/tree</span>
<span class="pre">_spec.json</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">output_dot</span></code></p></td>
<td><p>bool</p></td>
<td><p>Whether or not to output dot formatted
visualization files.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">seachat_plugins.core.policy.ngchat.ngChatPolicy</span><span class="w"></span>
<span class="w">    </span><span class="nt">dialogue_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./dialogue.yml</span><span class="w"></span>
<span class="w">    </span><span class="nt">nlu_threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.40</span><span class="w"></span>
<span class="w">    </span><span class="nt">use_mr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">    </span><span class="nt">mr_threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.40</span><span class="w"></span>
<span class="w">    </span><span class="nt">visual</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">visualization_directory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./visual</span><span class="w"></span>
<span class="w">      </span><span class="nt">output_static_visualization</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">      </span><span class="nt">output_at_each_turn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">      </span><span class="nt">output_live_update</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">      </span><span class="nt">output_vega</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">      </span><span class="nt">vega_spec_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./visual/flow_data.json</span><span class="w"></span>
<span class="w">      </span><span class="nt">output_dot</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="write-the-dialogue-file">
<h3><a class="toc-backref" href="#id16">Write the Dialogue File</a><a class="headerlink" href="#write-the-dialogue-file" title="Permalink to this headline"></a></h3>
<dl class="simple">
<dt>Write the rules/states that will guide the policy to determine the next action at any point in the conversation. Here are some tips and guiding principles to consider when writing the dialogue file:</dt><dd><ul class="simple">
<li><p>Start with states that have a simple ‘if this, then do that’ behavior and don’t rely on previous context; when all the simple states are working, then move on to the more complex states.</p></li>
<li><p>States with very concrete and specific conditions (for example, an intent that always triggers the same response) should have a high priority. Meanwhile, I think of the conversation path that leads towards the end goal as the undercurrent of the conversation; if the user doesn’t ask for anything more specific, the bot should default to leading the user to the end goal.</p>
<ul>
<li><p>For example, if the purpose of the bot is to get a user to order a coffee, the ‘order coffee’ path actually has a lower priority than most of the other states. This way, if the user asks for something specific, like seeing the menu or asking an FAQ, the bot will always address that first before heading back to the ‘order coffee’ path.</p></li>
</ul>
</li>
<li><p>As many states as possible should be available to the user at all times. Similarly, direct connections should be avoided unless necessary.</p></li>
<li><p>Direct connections should only be used in cases where entrance to the next state should be guarenteed if the conditions are met and/or if the state conditions cannot be restrictive enough to give admittance at the proper time.</p>
<ul>
<li><p>For example, the bot asks a yes or no question and the two direct connection states have the conditions <code class="docutils literal notranslate"><span class="pre">INTENT.name</span> <span class="pre">==</span> <span class="pre">affirm</span></code> and <code class="docutils literal notranslate"><span class="pre">INTENT.name</span> <span class="pre">==</span> <span class="pre">deny</span></code>. These conditions are not clear enough to be on their own, and if one of the conditions is met directly after the previous state, the state should be activated 100% of the time.</p></li>
</ul>
</li>
<li><p>A state should only be entered if its conditions are met, but restrict entrance to the state with its conditions so that it is only entered at the proper time</p></li>
</ul>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>yaml format does not like to start a value with a quotation mark unless the whole value is quoted (<code class="docutils literal notranslate"><span class="pre">'action_greet'</span></code>: OK | <code class="docutils literal notranslate"><span class="pre">'item'</span> <span class="pre">in</span> <span class="pre">ENTITIES</span></code>: ERROR). In this case you will have to quote the whole value and then use scare quotes for the substring: ex/ <code class="docutils literal notranslate"><span class="pre">&quot;'item'</span> <span class="pre">in</span> <span class="pre">ENTITIES&quot;</span></code></p>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorial_resources/bot_faq.html" class="btn btn-neutral float-left" title="FAQ Data Example" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="faq.html" class="btn btn-neutral float-right" title="SeaChat-FAQ" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2021, Seasalt.ai.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-10405841-8"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-10405841-8', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>