<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SeaChat-FAQ &mdash; Seasalt.ai Developers 0.0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SeaChat Cart Overview" href="../cart/readme.html" />
    <link rel="prev" title="SeaChat Policy" href="policy.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >
            <a href="../index.html" class="icon icon-home"> Seasalt.ai Developers
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Product Introductions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../product_introduction/seax.html">SeaX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../product_introduction/seavoice.html">SeaVoice</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SeaChat</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">SeaChat Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="bot_tutorial.html">SeaChat Bot Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="policy.html">SeaChat Policy</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">SeaChat FAQ</a><ul class="simple">
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SeaChat-cart</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cart/readme.html">SeaChat Cart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cart/seachat_cart.html">Technical Docs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SeaWord</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../nlp/readme.html">SeaWord</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nlp/sum_tutorial.html">Summarization API Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nlp/topic_tutorial.html">Topic Extraction API Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nlp/action_tutorial.html">Action Extraction API Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nlp/xlingualNER_tutorial.html">Cross Lingual NER API Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nlp/mr_tutorial.html">Machine Reading API Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nlp/redaction_tutorial.html">Redaction Service Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SeaVoice (Seasalt speech)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../speech/readme.html">SeaVoice README</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech/seavoice_sdk_python_tutorial.html">SeaVoice SDK (Python)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech/seavoice_restful_apis_tutorial.html">SeaVoice RESTful APIs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">NearMe</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../nearme/readme.html">NearMe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nearme/data_analytics_tutorial.html">NearMe Data Analytics Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SeaChat-report</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../report/index.html">Welcome to SeaChat-report’s documentation!</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Seasalt.ai Developers</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>SeaChat-FAQ</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/seachat/faq.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="seachat-faq">
<span id="id1"></span><h1>SeaChat-FAQ<a class="headerlink" href="#seachat-faq" title="Permalink to this headline"></a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id6">Introduction</a></p>
<ul>
<li><p><a class="reference internal" href="#where-rasa-s-default-faq-comes-short" id="id7">Where Rasa’s Default FAQ Comes Short</a></p></li>
<li><p><a class="reference internal" href="#how-seachat-faq-improves" id="id8">How SeaChat-FAQ Improves</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#configuration" id="id9">Configuration</a></p>
<ul>
<li><p><a class="reference internal" href="#minimal-configuration-for-faq-only" id="id10">Minimal Configuration for FAQ Only</a></p></li>
<li><p><a class="reference internal" href="#minimal-configuration-for-faq-nlu" id="id11">Minimal Configuration for FAQ + NLU</a></p></li>
<li><p><a class="reference internal" href="#full-configuration-for-faq-nlu-dialogue" id="id12">Full Configuration for FAQ + NLU + Dialogue</a></p></li>
<li><p><a class="reference internal" href="#faq-configuration-parameters" id="id13">FAQ Configuration Parameters</a></p>
<ul>
<li><p><a class="reference internal" href="#faqimporter" id="id14">FAQImporter</a></p></li>
<li><p><a class="reference internal" href="#elasticselector" id="id15">ElasticSelector</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#file-format" id="id16">File Format</a></p>
<ul>
<li><p><a class="reference internal" href="#faq-csv-file-format" id="id17">faq.csv File Format</a></p></li>
<li><p><a class="reference internal" href="#synonym-csv-file-format" id="id18">synonym.csv File Format</a></p></li>
<li><p><a class="reference internal" href="#stopwords-txt-file-format" id="id19">stopwords.txt File Format</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="introduction">
<h2><a class="toc-backref" href="#id6">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline"></a></h2>
<p>In this section we will walk you through SeaChat-FAQ: our Fast &amp; Accurate FAQ product.
Our FAQ product has the following features:</p>
<ul class="simple">
<li><p>support multiple FAQ sheets</p></li>
<li><p>support expiration dates, perfect for time-sensitive FAQs such as marketing promotions</p></li>
<li><p>Customizable thesaurus (synonyms)</p></li>
<li><p>Customizable stopword list</p></li>
<li><p>Transformers-based Pre-training</p></li>
<li><p>Supervised Fine-tuning</p></li>
<li><p>Probabilistic Reranking</p></li>
</ul>
<section id="where-rasa-s-default-faq-comes-short">
<h3><a class="toc-backref" href="#id7">Where Rasa’s Default FAQ Comes Short</a><a class="headerlink" href="#where-rasa-s-default-faq-comes-short" title="Permalink to this headline"></a></h3>
<p>SeaChat-FAQ is a great improvement to Rasa’s <a class="reference external" href="https://blog.rasa.com/response-retrieval-models/">ResponseSelector</a>, which is architected like this:</p>
<img alt="https://blog.rasa.com/content/images/2019/09/SRS-Blog--1--1.png" src="https://blog.rasa.com/content/images/2019/09/SRS-Blog--1--1.png" />
<p>The algorithm in a nutshell is: Build a classifier between <em>new queries</em> and existing <em>answers</em>
(Q&lt;-&gt;A match).</p>
<p>While it works reasonably well for small demos, it will not scale to larger dataset.
Suppose we have an FAQ sheet with 2,000 entries. This design has the following limitations:</p>
<ol class="arabic">
<li><p><strong>Data Sparsity</strong>: Because a SoftMax classifier is built for the number of FAQ entries,
<code class="docutils literal notranslate"><span class="pre">ResponseSelector</span></code> will need to build for 2,000 class labels, which faces data sparsity issues
given the small amount of FAQ pairs.</p>
<blockquote>
<div><ul class="simple">
<li><p>This has the implication of <strong>Long Training Time</strong> in production usage: if one FAQ entry is
changed, then Rasa retrains the whole classifier.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>Only Q&lt;-&gt;A Matching, no Q&lt;-&gt;Q Matching</strong>: comparison is made between new <em>queries</em> (Q) and
<em>answers</em> (A). However, the <em>questions</em> (Q) in an FAQ are not used at all.</p>
<blockquote>
<div><ul class="simple">
<li><p>This has the implication of <strong>Controllability</strong> in production usage: often when a query
does not match an FAQ entry, the user <em>cannot</em> very quickly add the query as a similar
question to the FAQ sheet to solve the problem.</p></li>
</ul>
</div></blockquote>
</li>
</ol>
<p>In essence, these shortcomings are due to the way that <em>Rasa treats the FAQ problem as
a classification (i.e., NLU) problem</em>. Based on years of research from the Information Retrieval
community, such as <a class="reference external" href="https://sigir.org/">SigIR</a>, we believe <em>FAQ problem is a retrieval and reranking problem</em>.</p>
</section>
<section id="how-seachat-faq-improves">
<h3><a class="toc-backref" href="#id8">How SeaChat-FAQ Improves</a><a class="headerlink" href="#how-seachat-faq-improves" title="Permalink to this headline"></a></h3>
<p>This is how SeaChat-FAQ works in a nutshell:</p>
<ol class="arabic simple">
<li><p><strong>Fast</strong>: Use ElasticSearch to index and retrieve related FAQ entries to a new query.</p></li>
<li><p><strong>Accurate</strong>: Use a customizable reranker to rerank the retrieved results.</p></li>
</ol>
<div class="admonition-generalization-vs-overfitting admonition">
<p class="admonition-title">Generalization vs. Overfitting</p>
<p>SeaChat-FAQ can use Transformer-based language model embeddings to index and compare
sentences to achieve better generalization and avoid the infamous overfitting problem.</p>
</div>
<p>Meanwhile, to make this product production-ready, SeaChat-FAQ adds synonym/stopwords support.
It also works with Excel sheets off-the-shelf, whose format is used by almost all customers.</p>
<div class="admonition-marketing-campaigns-supported admonition">
<p class="admonition-title">Marketing Campaigns Supported</p>
<p>SeaChat-FAQ comes with timezone support, and filters FAQ entries by its expiration
dates if presented. So it is suitable for running time-sensitive marketing campaigns such as promotions.</p>
</div>
</section>
</section>
<section id="configuration">
<h2><a class="toc-backref" href="#id9">Configuration</a><a class="headerlink" href="#configuration" title="Permalink to this headline"></a></h2>
<p>In this section we list a few common configurations for SeaChat-FAQ:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#minimal-configuration-for-faq-only"><span class="std std-ref">Minimal Configuration for FAQ Only</span></a></p></li>
<li><p><a class="reference internal" href="#minimal-configuration-for-faq-nlu"><span class="std std-ref">Minimal Configuration for FAQ + NLU</span></a></p></li>
<li><p><a class="reference internal" href="#full-configuration-for-faq-nlu"><span class="std std-ref">Full Configuration for FAQ + NLU + Dialogue</span></a></p></li>
</ol>
<section id="minimal-configuration-for-faq-only">
<span id="id2"></span><h3><a class="toc-backref" href="#id10">Minimal Configuration for FAQ Only</a><a class="headerlink" href="#minimal-configuration-for-faq-only" title="Permalink to this headline"></a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">language</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">en</span><span class="w"></span>
<span class="nt">importers</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">seachat_plugins.importers.faq_importer.FAQImporter</span><span class="w"></span>
<span class="w">    </span><span class="nt">faq_paths</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data/faq.csv</span><span class="w"></span>
<span class="w">    </span><span class="nt">synonym_paths</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data/synonym.csv</span><span class="w"></span>

<span class="nt">pipeline</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">seachat_plugins.nlu.selectors.elastic_selector.ElasticSelector</span><span class="w"></span>
<span class="w">    </span><span class="nt">stopword_paths</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data/stopwords.txt</span><span class="w">   </span><span class="c1"># must be in utf-8 encoding</span><span class="w"></span>
<span class="w">    </span><span class="nt">es_indexing</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">localhost</span><span class="w"></span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9200</span><span class="w"></span>
<span class="w">      </span><span class="nt">index_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">faq</span><span class="w">  </span><span class="c1"># must all be lower case, must not contain the characters #, \, /, *, ?, &quot;, &lt;, &gt;, |, ,</span><span class="w"></span>
</pre></div>
</div>
<p>The <a class="reference internal" href="#faqimporter"><span class="std std-ref">FAQImporter</span></a> reads FAQ/synonym data files on disk and validate them.
The <a class="reference internal" href="#elasticselector"><span class="std std-ref">ElasticSelector</span></a> builds an index for all the FAQ/synonym data with
ElasticSearch and trains a machine learning model to rerank the retrieved results.</p>
<p>If you run an <em>FAQ only</em> bot and have ElasticSearch locally running, the above configuration will
get you started. Note that the above configuration will completely bypass NLU: the NLU training files
will not even be read into SeaChat. Thus it is only suitable if you build an <em>FAQ-only</em> bot.</p>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<p>a normal user won’t be able to run the FAQ bot <em>locally</em> (only Seasalt developers can).
Need to change the params of ES to our online version</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><code class="docutils literal notranslate"><span class="pre">faq_paths</span></code> and <code class="docutils literal notranslate"><span class="pre">synonym_paths</span></code> support a list of files.</p>
</div>
</section>
<section id="minimal-configuration-for-faq-nlu">
<span id="id4"></span><h3><a class="toc-backref" href="#id11">Minimal Configuration for FAQ + NLU</a><a class="headerlink" href="#minimal-configuration-for-faq-nlu" title="Permalink to this headline"></a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">language</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">en</span><span class="w"></span>
<span class="nt">importers</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">seachat_plugins.importers.faq_importer.FAQImporter</span><span class="w"></span>
<span class="w">    </span><span class="nt">faq_paths</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data/faq.csv</span><span class="w"></span>
<span class="w">    </span><span class="nt">synonym_paths</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data/synonym.csv</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RasaFileImporter</span><span class="w"> </span><span class="c1"># import other training data from data folder, such as nlu.json and responses.md</span><span class="w"></span>

<span class="nt">pipeline</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WhitespaceTokenizer</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LexicalSyntacticFeaturizer</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CountVectorsFeaturizer</span><span class="w"></span>
<span class="w">    </span><span class="nt">analyzer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">char_wb</span><span class="w"></span>
<span class="w">    </span><span class="nt">min_ngram</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w"></span>
<span class="w">    </span><span class="nt">max_ngram</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DIETClassifier</span><span class="w"></span>
<span class="w">    </span><span class="nt">epochs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span><span class="w"></span>
<span class="w">    </span><span class="nt">random_seed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">42</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EntitySynonymMapper</span><span class="w">  </span><span class="c1"># enable this if you have synonyms in your .csv files and other NLU intents (RasaFileImporter is enabled)</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">seachat_plugins.nlu.selectors.elastic_selector.ElasticSelector</span><span class="w"></span>
<span class="w">    </span><span class="nt">stopword_paths</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data/stopwords.txt</span><span class="w">   </span><span class="c1"># must be in utf-8 encoding</span><span class="w"></span>
<span class="w">    </span><span class="nt">es_indexing</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">localhost</span><span class="w"></span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9200</span><span class="w"></span>
<span class="w">      </span><span class="nt">index_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">faq</span><span class="w">  </span><span class="c1"># must all be lower case, must not contain the characters #, \, /, *, ?, &quot;, &lt;, &gt;, |, ,</span><span class="w"></span>
</pre></div>
</div>
<p>For importing NLU data, the default <a class="reference external" href="https://rasa.com/docs/rasa/training-data-importers/">RasaFileImporter</a> needs to be used. Then SeaChat searches corresponding training data
from the <code class="docutils literal notranslate"><span class="pre">data</span></code> folder by default.</p>
<p>For training NLU, <a class="reference external" href="https://rasa.com/docs/rasa/tuning-your-model">configure the NLU pipeline</a>
as usual. Just replace the default <a class="reference external" href="https://rasa.com/docs/rasa/2.0.x/components#responseselector">ResponseSelector</a>.
with SeaChat’s <code class="docutils literal notranslate"><span class="pre">ElasticSelector</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>SeaChat’s components are designed as plugins to Rasa that you only need to add them
to your <code class="docutils literal notranslate"><span class="pre">config.yml</span></code> file or replace a default component.</p>
</div>
</section>
<section id="full-configuration-for-faq-nlu-dialogue">
<span id="full-configuration-for-faq-nlu"></span><h3><a class="toc-backref" href="#id12">Full Configuration for FAQ + NLU + Dialogue</a><a class="headerlink" href="#full-configuration-for-faq-nlu-dialogue" title="Permalink to this headline"></a></h3>
<p>The following is a comprehensive example of <code class="docutils literal notranslate"><span class="pre">config.yml</span></code> for both FAQ and NLU,
for the Chinese language. A lot of parameters are tunable. We refer you to
<a class="reference internal" href="#faq-config-params"><span class="std std-ref">FAQ Configuration Parameters</span></a> for details.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">language</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">zh</span><span class="w"></span>
<span class="nt">importers</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="c1"># Please place FAQImporter before other importers</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">seachat_plugins.importers.faq_importer.FAQImporter</span><span class="w"></span>
<span class="w">    </span><span class="nt">faq_paths</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data/faq.csv</span><span class="w"></span>
<span class="w">    </span><span class="nt">synonym_paths</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data/zh_tw_synonym.csv</span><span class="w"></span>
<span class="w">    </span><span class="nt">output_test_faq_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tests/test_faq.md</span><span class="w">   </span><span class="c1"># used for `test nlu`, default to tests/test_faq.md: please don&#39;t change the default path</span><span class="w"></span>
<span class="w">    </span><span class="nt">augment_with_synonyms</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"> </span><span class="c1"># recommended if you have synonyms</span><span class="w"></span>
<span class="w">    </span><span class="nt">timezone</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">America/Los_Angeles</span><span class="w"> </span><span class="c1"># timezone used for dates in your faq file. Expressed as TZ database name. E.g. Seattle is &quot;America/Los_Angeles&quot;.</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RasaFileImporter</span><span class="w"> </span><span class="c1"># import other training data from data folder, such as nlu.json and responses.md</span><span class="w"></span>

<span class="nt">pipeline</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">seachat_plugins.nlu.tokenizers.zhchar_tokenizer.ZhCharTokenizer</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LexicalSyntacticFeaturizer</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CountVectorsFeaturizer</span><span class="w"></span>
<span class="w">    </span><span class="nt">analyzer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">char_wb</span><span class="w"></span>
<span class="w">    </span><span class="nt">min_ngram</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w"></span>
<span class="w">    </span><span class="nt">max_ngram</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DIETClassifier</span><span class="w"></span>
<span class="w">    </span><span class="nt">epochs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span><span class="w"></span>
<span class="w">    </span><span class="nt">random_seed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">42</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EntitySynonymMapper</span><span class="w">  </span><span class="c1"># enable this if you have synonyms in your .csv files and other NLU intents (RasaFileImporter is enabled)</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">seachat_plugins.nlu.selectors.elastic_selector.ElasticSelector</span><span class="w"></span>
<span class="w">    </span><span class="nt">stopword_paths</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data/stopwords_zh_tw.txt</span><span class="w">   </span><span class="c1"># must be in utf-8 encoding</span><span class="w"></span>
<span class="w">    </span><span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text</span><span class="w"> </span><span class="c1"># options: text, bert</span><span class="w"></span>
<span class="w">    </span><span class="nt">es_indexing</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">localhost</span><span class="w"></span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9200</span><span class="w"></span>
<span class="w">      </span><span class="nt">index_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">faq</span><span class="w">  </span><span class="c1"># must all be lower case, must not contain the characters #, \, /, *, ?, &quot;, &lt;, &gt;, |, ,</span><span class="w"></span>
<span class="w">      </span><span class="nt">make_index_name_unique</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w">  </span><span class="c1"># if true, append index_name with a time str, e.g. &quot;faq-2020-11-15T02-36-48&quot;</span><span class="w"></span>
<span class="w">    </span><span class="nt">bert_client</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">      </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bert-as-service</span><span class="w"></span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5555</span><span class="w"> </span><span class="c1"># port for pushing data from client to server</span><span class="w"></span>
<span class="w">      </span><span class="nt">port_out</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5556</span><span class="w"> </span><span class="c1"># port for publishing results from server to client</span><span class="w"></span>
<span class="w">      </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">600000</span><span class="w"> </span><span class="c1"># in milliseconds, -1 for no limit, apply to both connecting to server and total encoding time,</span><span class="w"></span>
<span class="w">    </span><span class="nt">eval</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">      </span><span class="nt">metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">map, mrr</span><span class="w"> </span><span class="c1"># options: map, mrr</span><span class="w"></span>
<span class="w">      </span><span class="nt">N</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1, 3</span><span class="w"></span>
<span class="w">    </span><span class="nt">reranker</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">      </span><span class="nt">identity_match_score_override</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.95</span><span class="w"> </span><span class="c1"># set to this value if identify match confidence is lower than this value, set to 0 or minus to disable it</span><span class="w"></span>
<span class="w">      </span><span class="nt">params</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">random_state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">42</span><span class="w"></span>
<span class="w">        </span><span class="nt">class_weight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">balanced</span><span class="w"></span>
<span class="w">        </span><span class="nt">C</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w">  </span><span class="c1"># lower C means higher regularization, sometimes higher confidence value</span><span class="w"></span>
<span class="w">        </span><span class="nt">penalty</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">l2</span><span class="w"></span>
<span class="w">      </span><span class="nt">features</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">es_bow_cos_sim</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">        </span><span class="nt">es_bow_elem_prod</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">count</span><span class="w"> </span><span class="c1"># options: count, hashing</span><span class="w"></span>
<span class="w">          </span><span class="nt">n_features</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10000</span><span class="w"> </span><span class="c1"># n_features for HashingVectorizer, multiplied by n for each n-gram</span><span class="w"></span>
<span class="w">          </span><span class="nt">min_n</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w"></span>
<span class="w">          </span><span class="nt">max_n</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span><span class="w"></span>
<span class="w">        </span><span class="nt">es_doc_score</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>

<span class="c1"># Configuration for Rasa Core.</span><span class="w"></span>
<span class="c1"># https://rasa.com/docs/rasa/core/policies/</span><span class="w"></span>
<span class="nt">policies</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="c1"># If exact conversation is present in train stories, predicts next action with confidence 1</span><span class="w"></span>
<span class="w">  </span><span class="c1"># name: MemoizationPolicy</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">seachat_plugins.core.policy.ngchat.ngChatPolicy</span><span class="w"></span>
<span class="w">    </span><span class="nt">dialogue_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./dialogue.yml</span><span class="w"></span>
<span class="w">    </span><span class="nt">nlu_threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.40</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MappingPolicy</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="faq-configuration-parameters">
<span id="faq-config-params"></span><h3><a class="toc-backref" href="#id13">FAQ Configuration Parameters</a><a class="headerlink" href="#faq-configuration-parameters" title="Permalink to this headline"></a></h3>
<section id="faqimporter">
<span id="faq-importer"></span><h4><a class="toc-backref" href="#id14">FAQImporter</a><a class="headerlink" href="#faqimporter" title="Permalink to this headline"></a></h4>
<p>Configuration:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">faq_paths</span></code></dt><dd><p>A list of files to the FAQ .csv files, with relative path respective of the current
configuration file. See <a class="reference internal" href="#faq-csv-format"><span class="std std-ref">faq.csv File Format</span></a> for file format.</p>
<p>Example: <code class="docutils literal notranslate"><span class="pre">data/faq.csv</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">synonym_paths</span></code></dt><dd><p>A list of files to the FAQ .csv files, with relative path respective of the current
configuration file. See <a class="reference internal" href="#faq-csv-format"><span class="std std-ref">faq.csv File Format</span></a> for file format.</p>
<p>Example: <code class="docutils literal notranslate"><span class="pre">data/faq.csv</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">output_test_faq_file</span></code></dt><dd><p>Used for <code class="docutils literal notranslate"><span class="pre">rasa</span> <span class="pre">test</span> <span class="pre">nlu</span></code> for FAQ-specific testing. By default <code class="docutils literal notranslate"><span class="pre">rasa</span> <span class="pre">test</span> <span class="pre">nlu</span></code> only tells a
coarse-grained number on the overall <code class="docutils literal notranslate"><span class="pre">faq</span></code> intent. For instance, in <code class="docutils literal notranslate"><span class="pre">results/intent_report.json</span></code>:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;faq&quot;</span><span class="o">:</span> <span class="p">{</span>
  <span class="s2">&quot;precision&quot;</span><span class="o">:</span> <span class="mf">0.6</span><span class="p">,</span>
  <span class="s2">&quot;recall&quot;</span><span class="o">:</span> <span class="mf">1.0</span><span class="p">,</span>
  <span class="s2">&quot;f1-score&quot;</span><span class="o">:</span> <span class="mf">0.7499999999999999</span><span class="p">,</span>
  <span class="s2">&quot;support&quot;</span><span class="o">:</span> <span class="mf">6</span><span class="p">,</span>
  <span class="s2">&quot;confused_with&quot;</span><span class="o">:</span> <span class="p">{}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>However, with the generated test file for FAQ now a more detailed
<code class="docutils literal notranslate"><span class="pre">results/response_selection_report.json</span></code> file is reported:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;en_faq_sample_3&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;precision&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;recall&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;f1-score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;support&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;confused_with&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">  </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;en_faq_sample_8&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;precision&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;recall&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;f1-score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;support&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;confused_with&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">  </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;accuracy&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;macro avg&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;precision&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;recall&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;f1-score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;support&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="w"></span>
<span class="w">  </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;weighted avg&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;precision&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;recall&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;f1-score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;support&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Example: <code class="docutils literal notranslate"><span class="pre">tests/test_faq.md</span></code> (default)</p>
<p>The specific backend command that can be used to run with the test files is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rasa <span class="nb">test</span> nlu -u tests/test_faq.md -c config_local_only_faq.yml   --successes -vv --no-plot
</pre></div>
</div>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">augment_with_synonyms</span></code></dt><dd><p>Whether to augment training data with synonyms.</p>
<p>Example: <code class="docutils literal notranslate"><span class="pre">true</span></code>/<code class="docutils literal notranslate"><span class="pre">false</span></code>, default to true if <code class="docutils literal notranslate"><span class="pre">synonym_paths</span></code> is included.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">timezone</span></code></dt><dd><p>Timezone used for dates in your faq file (See <a class="reference internal" href="#faq-csv-format"><span class="std std-ref">faq.csv File Format</span></a> for file format).
Please refer to the “Canonical ID” column in <a class="reference external" href="http://joda-time.sourceforge.net/timezones.html">this list</a>.
This is also the format accepted by the
<a class="reference external" href="https://www.elastic.co/guide/en/logstash/current/plugins-filters-date.html#plugins-filters-date-timezone">ElasticSearch timezone</a>.</p>
<p>Example: <code class="docutils literal notranslate"><span class="pre">America/Los_Angeles</span></code>, default to local timezone.</p>
</dd>
</dl>
</section>
<section id="elasticselector">
<span id="elastic-selector"></span><h4><a class="toc-backref" href="#id15">ElasticSelector</a><a class="headerlink" href="#elasticselector" title="Permalink to this headline"></a></h4>
<p>Configuration:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">stopword_paths</span></code></dt><dd><p>A list of files that contain stopwords, with relative path respective of the current
configuration file. See <a class="reference internal" href="#stopwords-txt-format"><span class="std std-ref">stopwords.txt File Format</span></a> for file format.</p>
<p>Example: <code class="docutils literal notranslate"><span class="pre">data/stopwords_zh_tw.txt</span></code>, must be in utf-8 encoding</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">method</span></code></dt><dd><p>The text representation method to be used for ElasticSearch indexing and similarity matching.
<code class="docutils literal notranslate"><span class="pre">text</span></code> represents using ElasticSearch text analytics, while <code class="docutils literal notranslate"><span class="pre">bert</span></code> represents using BERT
embeddings (must enable <code class="docutils literal notranslate"><span class="pre">bert_client</span></code>, see below).</p>
<p>Example: <code class="docutils literal notranslate"><span class="pre">text</span></code> (default), options: <code class="docutils literal notranslate"><span class="pre">text</span></code>, <code class="docutils literal notranslate"><span class="pre">bert</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">es_indexing</span></code></dt><dd><p>Configuration parameters for your ElasticSearch instance:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">host</span></code>: address of the Elasticsearch. When running locally, set to <code class="docutils literal notranslate"><span class="pre">localhost</span></code>.
Can also be set through environment variable <code class="docutils literal notranslate"><span class="pre">ES_HOST</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">port</span></code>: port of the Elasticsearch.
Can also be set through environment variable <code class="docutils literal notranslate"><span class="pre">ES_PORT</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index_name</span></code>: the name of the ES index to be injected. If the index already exists,
it will be deleted and the current data will be inserted into this index.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">login</span></code> and <code class="docutils literal notranslate"><span class="pre">secret</span></code>: they can be set here in the config file, or can be set through
environment variables <code class="docutils literal notranslate"><span class="pre">ES_LOGIN</span></code> and `` ES_SECRET``.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index_name</span></code>: ElasticSearch index name. Must all be lower case, must not contain the characters
<code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">\</span> <span class="pre">/</span> <span class="pre">*</span> <span class="pre">?</span> <span class="pre">&quot;</span> <span class="pre">&lt;</span> <span class="pre">&gt;</span> <span class="pre">|</span> <span class="pre">,</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">make_index_name_unique</span></code>: If true, append index_name with a time str, e.g.
“faq-2020-11-15T02-36-48”, default to false.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In production system, set <code class="docutils literal notranslate"><span class="pre">make_index_name_unique</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code> to avoid index pollution.</p>
<p>If it is set to <code class="docutils literal notranslate"><span class="pre">false</span></code>, changing the FAQ .csv file will pollute the ElasticSearch index
because the same index is reused.</p>
</div>
</li>
</ul>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">bert_client</span></code></dt><dd><p>Configuration parameters for <a class="reference external" href="https://github.com/hanxiao/bert-as-service">bert-as-service</a>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code>: when set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, Bert embeddings will be used in both ElasticSearch and reranker.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">host</span></code>: host address. Can also be set through environment variable <code class="docutils literal notranslate"><span class="pre">BERT_HOST</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">port</span></code>: port for pushing data from client to server, example: <code class="docutils literal notranslate"><span class="pre">5555</span></code>
(<a class="reference external" href="https://github.com/hanxiao/bert-as-service#client-api">doc</a>).
Can also be set through environment variable <code class="docutils literal notranslate"><span class="pre">BERT_PORT</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">port_out</span></code>: port for publishing results from server to client, example: <code class="docutils literal notranslate"><span class="pre">5556</span></code>
(<a class="reference external" href="https://github.com/hanxiao/bert-as-service#client-api">doc</a>).
Can also be set through environment variable <code class="docutils literal notranslate"><span class="pre">BERT_PORT_OUT</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">timeout</span></code>: time system waits for response from BERT server before aborting. In milliseconds.
-1 for no limit. Applies to both connecting to the BERT server and time cost for encoding data.
If encoding large data but has a small timeout value set here, the training process will also be
interrupted, so make the value generous for large dataset. Can also be set through environment variable <code class="docutils literal notranslate"><span class="pre">BERT_TIMEOUT</span></code>. Example: <code class="docutils literal notranslate"><span class="pre">600000</span></code>.</p></li>
</ul>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">eval</span></code></dt><dd><p>Automatic evaluation parameters during SeaChat-FAQ training.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">eval</span></code> and <code class="docutils literal notranslate"><span class="pre">bert_client</span></code> are both enabled, the system performs an automatic evaluation of
both text indexing and BERT indexing using <code class="docutils literal notranslate"><span class="pre">metric&#64;N</span></code>, and chooses the one with the higher score.
The user-specified method is ignored</p>
<p>If only <cite>eval</cite> is enabled, then the system just reports its performance according to <cite>metric</cite>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code>: true or false</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">metric</span></code>: Options are <code class="docutils literal notranslate"><span class="pre">map</span></code> (<a class="reference external" href="https://en.wikipedia.org/wiki/Evaluation_measures_(information_retrieval)">Mean Average Precision</a>)
or <code class="docutils literal notranslate"><span class="pre">mrr</span></code> (<a class="reference external" href="https://en.wikipedia.org/wiki/Mean_reciprocal_rank">Mean Reciprocal Rank</a>),
where MAP&#64;N for a total of Q queries is defined as:</p>
<p class="centered">
<strong><span class="math notranslate nohighlight">\(\text{MAP&#64;N}= \frac{1}{Q}(\frac{1}{TP_{seen}}\sum_{i=1}^{N}\frac{TP_{seen}}{i}\cdot relevant(i))\)</span></strong></p><p>See <a class="reference external" href="http://sdsawtelle.github.io/blog/output/mean-average-precision-MAP-for-recommender-systems.html#Common-Variations-on-AP-Formula">notation</a>.
Note that MAP and MRR equal when N=1.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code>: cutoff for MAP/MRR&#64;N, recommended options are <code class="docutils literal notranslate"><span class="pre">1</span></code> or <code class="docutils literal notranslate"><span class="pre">3</span></code>, or <code class="docutils literal notranslate"><span class="pre">1,</span> <span class="pre">3</span></code>.</p></li>
</ul>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">reranker</span></code></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">reranker</span></code> is enabled and text indexing is used, an MaxEnt reranker will be used.
Otherwise if <code class="docutils literal notranslate"><span class="pre">bert_client</span></code> is used, a neural network reranker will be used.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code>: true. We recommend always setting this to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">identity_match_score_override</span></code>: The confidence score will be set to this value if a query
is an exact match to a question in the FAQ .csv file <em>if</em> when the reranker confidence score
is lower than this value. For instance, sometimes the ranker outputs a lowe value such as
<code class="docutils literal notranslate"><span class="pre">0.78</span></code> even with identical match. This parameter is used to manually intervene this behavior.
Set to 0 or minus to disable it. Example: <code class="docutils literal notranslate"><span class="pre">0.95</span></code>.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">params</span></code>: reranker parameters</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">random_state</span></code>: random seed, default to <code class="docutils literal notranslate"><span class="pre">42</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">class_weight</span></code>: weight to assign each class label, options are <code class="docutils literal notranslate"><span class="pre">balanced</span></code> and <code class="docutils literal notranslate"><span class="pre">null</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">C</span></code>: Inverse of regularization strength, must be larger than 0. Lower C means higher
regularization, sometimes higher confidence value. Default to <code class="docutils literal notranslate"><span class="pre">1.0</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">penalty</span></code>: L1 or L2 norms in regularization. Options are <code class="docutils literal notranslate"><span class="pre">l1</span></code> and <code class="docutils literal notranslate"><span class="pre">l2</span></code>.
Default to <code class="docutils literal notranslate"><span class="pre">l2</span></code>.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">features</span></code>: These features are for text indexing and MaxEnt Reranker (method: <code class="docutils literal notranslate"><span class="pre">text</span></code>) only.</dt><dd><ul>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">es_bow_cos_sim</span></code>: Cosine similarity between query and document bag-of-ngrams vectors</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code>: <code class="docutils literal notranslate"><span class="pre">true</span></code> (default) or <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">es_bow_elem_prod</span></code>: Elementwise product of query and document n-gram vectors</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code>: options are <code class="docutils literal notranslate"><span class="pre">count</span></code> and <code class="docutils literal notranslate"><span class="pre">hashing</span></code>. On a small dataset, <code class="docutils literal notranslate"><span class="pre">count</span></code> is
preferred. On a large dataset, <code class="docutils literal notranslate"><span class="pre">hashing</span></code> and <code class="docutils literal notranslate"><span class="pre">count</span></code> are not very different in terms
of accuracy, but <code class="docutils literal notranslate"><span class="pre">hashing</span></code> might save more memory.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_features</span></code>: This only applies if type is <code class="docutils literal notranslate"><span class="pre">hashing</span></code>, used to limit the number
of total features to avoid OOM. Example: <code class="docutils literal notranslate"><span class="pre">10000</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min_n</span></code> and <code class="docutils literal notranslate"><span class="pre">max_n</span></code>: range of n-grams to be used.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">es_doc_score</span></code>: Elasticsearch score of each retrieved document</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code>: <code class="docutils literal notranslate"><span class="pre">true</span></code> (default) or <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</section>
</section>
</section>
<section id="file-format">
<h2><a class="toc-backref" href="#id16">File Format</a><a class="headerlink" href="#file-format" title="Permalink to this headline"></a></h2>
<section id="faq-csv-file-format">
<span id="faq-csv-format"></span><h3><a class="toc-backref" href="#id17">faq.csv File Format</a><a class="headerlink" href="#faq-csv-file-format" title="Permalink to this headline"></a></h3>
<p>The FAQ .csv file is a utf-8 encoded .csv file with the following header:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ID</span></code>: any unique number or string to denote this FAQ entry.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Answer</span></code>: answer in an FAQ entry</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Category</span></code>: reserved for customers who want to categorize their FAQs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Keywords</span></code>: reserved for customers who want to describe their FAQs with keywords.
It is used for retrieval too.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">From</span> <span class="pre">date</span></code>: if set, the FAQ will be effective <em>from</em> this date (inclusive); if not set,
then the FAQ is effective until <code class="docutils literal notranslate"><span class="pre">To</span> <span class="pre">date</span></code>. Accepted format
is the one that can be parsed by <a class="reference external" href="https://dateparser.readthedocs.io/en/latest/">dateparser</a>.
Example: “January 12, 2021”, “1/12/2021”.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">To</span> <span class="pre">date</span></code>: if set, the FAQ will be effective <em>through</em> this date (inclusive); if not set,
then the FAQ will not expire.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Question</span></code>, <code class="docutils literal notranslate"><span class="pre">Question</span></code>, <code class="docutils literal notranslate"><span class="pre">More</span> <span class="pre">Questions</span></code>, <code class="docutils literal notranslate"><span class="pre">...</span></code>: a list of similar questions to this FAQ entry.</p></li>
</ul>
<p>Correspondingly, if your FAQ is in Simplified or Traditional Chinese, the following header is assumed:</p>
<ul class="simple">
<li><p>Simplified Chinese: (‘ID’, ‘答案’, ‘分类’, ‘关键词’, ‘开始日期’, ‘结束日期’, ‘问题’, ‘问题’, ‘更多问题’, …)</p></li>
<li><p>Traditional Chinese: (‘ID’, ‘回答’, ‘類目’, ‘關鍵詞’, ‘開始日期’, ‘結束日期’, ‘問題’, ‘問題’, ‘更多問題’, …)</p></li>
</ul>
<p><a class="reference download internal" download="" href="../_downloads/fcfd38bab7a134e2beaad33a042e5073/en_faq_sample.csv"><code class="xref download docutils literal notranslate"><span class="pre">Sample</span> <span class="pre">FAQ</span> <span class="pre">csv</span> <span class="pre">file:</span> <span class="pre">en_faq_sample.csv</span></code></a></p>
</section>
<section id="synonym-csv-file-format">
<span id="synonym-csv-format"></span><h3><a class="toc-backref" href="#id18">synonym.csv File Format</a><a class="headerlink" href="#synonym-csv-file-format" title="Permalink to this headline"></a></h3>
<p>The synonym .csv file’s format is very simple: just on each line list a group of synonyms, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Linux</span><span class="p">,</span><span class="n">Unix</span><span class="p">,</span><span class="n">GNU</span><span class="o">/</span><span class="n">Linux</span>
<span class="n">software</span><span class="p">,</span><span class="n">program</span><span class="p">,</span><span class="n">code</span>
<span class="n">kernel</span><span class="p">,</span><span class="n">linux</span> <span class="n">kernel</span>
<span class="nb">open</span> <span class="n">source</span><span class="p">,</span><span class="n">free</span> <span class="n">software</span>
<span class="n">sell</span><span class="p">,</span><span class="n">trade</span><span class="p">,</span><span class="n">vend</span><span class="p">,</span><span class="n">auction</span>
<span class="n">charge</span><span class="p">,</span><span class="n">pay</span><span class="p">,</span><span class="n">cost</span>
</pre></div>
</div>
<p><a class="reference download internal" download="" href="../_downloads/33ae5088fac8bd67adf8db3ed7ce740c/en_synonym_sample.csv"><code class="xref download docutils literal notranslate"><span class="pre">Sample</span> <span class="pre">synonym</span> <span class="pre">csv</span> <span class="pre">file:</span> <span class="pre">en_synonym_sample.csv</span></code></a></p>
</section>
<section id="stopwords-txt-file-format">
<span id="stopwords-txt-format"></span><h3><a class="toc-backref" href="#id19">stopwords.txt File Format</a><a class="headerlink" href="#stopwords-txt-file-format" title="Permalink to this headline"></a></h3>
<p>The stopword list is a .txt file that on each line one stopword is placed. Please make sure the
txt file is utf-8 encoded.</p>
<p><a class="reference download internal" download="" href="../_downloads/db2a7b6cda809a7260eae7a75646bd2d/zh_tw_stopwords.txt"><code class="xref download docutils literal notranslate"><span class="pre">Sample</span> <span class="pre">stopwords</span> <span class="pre">txt</span> <span class="pre">file:</span> <span class="pre">zh_tw_stopwords.txt</span></code></a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>currently customizable stopword is supported only with <code class="docutils literal notranslate"><span class="pre">language:</span> <span class="pre">zh</span></code>. For other languages
the default ElasticSearch <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-stop-tokenfilter.html">stopword filter</a> is used.</p>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="policy.html" class="btn btn-neutral float-left" title="SeaChat Policy" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../cart/readme.html" class="btn btn-neutral float-right" title="SeaChat Cart Overview" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2021, Seasalt.ai.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-10405841-8"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-10405841-8', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>